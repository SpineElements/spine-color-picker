<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../iron-icons/editor-icons.html">
<link rel="import" href="../spine-icon-button/spine-icon-button.html">

<link rel="import" href="./spine-color-picker-light.html">

<!--
 An element to hold the color set and provide selection between them. By default contains the
 Material colors set. Behaves as a simple icon button with a drop down content.

 Example:
 ```
    <spine-color-picker value="{{selectedColor}}"></spine-color-picker>
 ```

 ### Styling

 See `SpineColorPickerLight` for a full list of custom properties used to style this element.

 The following custom properties and mixins are available for styling:

 Custom property | Description | Default
 ----------------|-------------|----------
 `--spine-color-picker-trigger` | Mixin applied to the dropdown trigger | {}
-->
<dom-module id="spine-color-picker">
    <template>
        <style>
            :host {
                display: inline-block;
                flex: 0;
                text-align: center;
            }

            spine-icon-button {
                height: 32px;
                width: 32px;
                padding: 4px;

                @apply --spine-color-picker-trigger;
            }

            #preview {
                width: calc(100% - 8px);
                margin: 4px;
                height: 4px;
                position: absolute;
                bottom: 0;
                left: 0;
                background: transparent;
            }

            #preview[white] {
                height: 2px;
                width: calc(100% - 10px);
                border: 1px solid rgba(0, 0, 0, .1);
            }

            #button-suffix {
                position: absolute;
                left: calc(100% - 3px);
                top: 0;
                color: var(--light-theme-secondary-color);
                height: 20px;
            }
        </style>

        <spine-color-picker-light value="{{value}}" colors="[[colors]]">
            <spine-icon-button disabled="[[disabled]]"
                               icon="editor:format-color-fill">
                <iron-icon id="button-suffix" icon="icons:arrow-drop-down"></iron-icon>
                <div id="preview" style$="background: [[value]]" white$="[[_isWhite]]"></div>
            </spine-icon-button>
        </spine-color-picker-light>
    </template>

    <script>{
        class SpineColorPicker extends Polymer.Element {
            static get is() {
                return 'spine-color-picker';
            }

            static get properties() {
                /**
                 * Fired when color item is selected.
                 *
                 * @event spine-color-picker-select
                 * @param {string} value Selected color
                 */

                return {
                    /**
                     * The selected value.
                     */
                    value: {
                        type: String,
                        notify: true
                    },

                    /**
                     * The colors set to display as the popup content. The Material colors is used
                     * as a default value. Expected type is a two dimensional array of CSS hex or
                     * rgb colors. Each array represents one displayed row.
                     */
                    colors: Object,

                    _isWhite: {
                        type: Boolean,
                        computed: '_isWhiteColor(value)'
                    }
                };
            }

            /**
             * Indicates if provided color is white.
             *
             * @param color Color value
             * @return {boolean} True if provided color is white
             * @protected
             */
            _isWhiteColor(color) {
                return color &&
                    (color === '#fff' || color === '#ffffff' || color === 'rgb(255, 255, 255)');

            }
        }

        window.customElements.define(SpineColorPicker.is, SpineColorPicker);
    }</script>
</dom-module>
